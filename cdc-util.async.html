<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>cdc-util.async documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Cdc-util</span> <span class="project-version">1.3.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cdc-util</span></div></div></li><li class="depth-2 branch current"><a href="cdc-util.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>components</span></div></div></li><li class="depth-3 branch"><a href="cdc-util.components.database.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>database</span></div></a></li><li class="depth-3"><a href="cdc-util.components.kafka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kafka</span></div></a></li><li class="depth-2 branch"><a href="cdc-util.env.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>env</span></div></a></li><li class="depth-2 branch"><a href="cdc-util.filter.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>filter</span></div></a></li><li class="depth-2 branch"><a href="cdc-util.format.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>format</span></div></a></li><li class="depth-2 branch"><a href="cdc-util.kafka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kafka</span></div></a></li><li class="depth-2"><a href="cdc-util.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-3"><a href="cdc-util.schema.oracle-refs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oracle-refs</span></div></a></li><li class="depth-2"><a href="cdc-util.validate.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>validate</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="cdc-util.async.html#var-go-till-closed"><div class="inner"><span>go-till-closed</span></div></a></li><li class="depth-1"><a href="cdc-util.async.html#var-noop-transducer"><div class="inner"><span>noop-transducer</span></div></a></li><li class="depth-1"><a href="cdc-util.async.html#var-pipe-ret-last"><div class="inner"><span>pipe-ret-last</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">cdc-util.async</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-go-till-closed"><h3>go-till-closed</h3><div class="usage"><code>(go-till-closed chans loop-fn)</code><code>(go-till-closed chans loop-fn close?)</code></div><div class="doc"><div class="markdown"><p>Returns a <code>java.io.Closeable</code> encapsulated <code>go</code> block that takes values from the given <code>chans</code> (a single channel or collection of channels) providing them to the <code>loop-fn</code> when received until <code>.close</code>d.</p>
<p><code>loop-fn</code> should have the signature <code>(fn [val ch] ...)</code>, where <code>val</code> is the value read and <code>ch</code> is the channel read from.</p>
<p>If <code>close?</code> is true, the default, then all of the provided channels will be closed when <code>.close</code> is called on the returned block.</p></div></div><div class="src-link"><a href="https://github.com/lymingtonprecision/cdc-util/blob/master/src/cdc_util/async.clj#L27">view source</a></div></div><div class="public anchor" id="var-noop-transducer"><h3>noop-transducer</h3><div class="usage"><code>(noop-transducer)</code><code>(noop-transducer f)</code></div><div class="doc"><div class="markdown"><p>Returns a transducer that does nothing, returning the result set unchanged in response to any input (and passing through completion/init arity calls.)</p>
<p>If a function, <code>f</code>, is provided it will be called with each received input value (and only the input value) but its return value will be ignored.</p>
<p>Note that this <em>will</em> short circuit a transducer composition:</p>
<pre><code>(into
 []
 (comp (map #(* % 2)) (noop-transducer))
 (range 1 10))
;=&gt; []
</code></pre>
<p>Therefore it should only be used in situations where discarding every input and returning the initial value is the desired behaviour. The primary use case is performing an operation on values received by a <code>core.async</code> channel:</p>
<pre><code>;; log every value received on a channel, but never put the
;; values on the channel
(def ch (async/chan 1 (noop-transducer #(clojure.tools.logging/info %))))
(async/&gt;!! ch &quot;test&quot;)
(async/&gt;!! ch {:logging true :updating false})
(async/close! ch)
</code></pre>
<p>Useful primarily in situations where you want to use a channel as a (blocking) pipe to some external system but only care about the operation being performed and not capturing a return value (e.g. updating a database, sending emails, posting to Apache Kafka, etc.)</p></div></div><div class="src-link"><a href="https://github.com/lymingtonprecision/cdc-util/blob/master/src/cdc_util/async.clj#L57">view source</a></div></div><div class="public anchor" id="var-pipe-ret-last"><h3>pipe-ret-last</h3><div class="usage"><code>(pipe-ret-last from-chan to-chan)</code><code>(pipe-ret-last from-chan to-chan close?)</code></div><div class="doc"><div class="markdown"><p>Pipes items from <code>from-chan</code> to <code>to-chan</code> returning a channel that will receive the last value read from <code>from-chan</code> when it closes.</p>
<p>If <code>close?</code> is <code>true</code>, the default, then <code>to-chan</code> will be closed when <code>from-chan</code> closes.</p></div></div><div class="src-link"><a href="https://github.com/lymingtonprecision/cdc-util/blob/master/src/cdc_util/async.clj#L7">view source</a></div></div></div></body></html>